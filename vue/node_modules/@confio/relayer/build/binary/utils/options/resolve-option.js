"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveOption = void 0;
const InvalidOptionError_1 = require("../../exceptions/InvalidOptionError");
function resolveOption(identifier, optionsParam) {
    return (...args) => {
        var _a, _b;
        const options = {
            required: (_a = optionsParam === null || optionsParam === void 0 ? void 0 : optionsParam.required) !== null && _a !== void 0 ? _a : false,
            integer: (_b = optionsParam === null || optionsParam === void 0 ? void 0 : optionsParam.integer) !== null && _b !== void 0 ? _b : false,
        };
        const value = findValue(...args);
        if (value === null) {
            if (options.required) {
                throw new InvalidOptionError_1.InvalidOptionError(`"${identifier}" option is required.`);
            }
            return null;
        }
        if (options.integer) {
            const parsedValue = parseInt(value, 10);
            if (isNaN(parsedValue)) {
                throw new InvalidOptionError_1.InvalidOptionError(`"${identifier}" option has value "${value}" while it must be an integer.`);
            }
            return parsedValue;
        }
        return value;
    };
}
exports.resolveOption = resolveOption;
function findValue(...args) {
    for (const option of args) {
        const value = typeof option === 'function' ? option() : option;
        if (value !== undefined && value !== null) {
            return value;
        }
    }
    return null;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb2x2ZS1vcHRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYmluYXJ5L3V0aWxzL29wdGlvbnMvcmVzb2x2ZS1vcHRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNEVBQXlFO0FBNEJ6RSxTQUFnQixhQUFhLENBQzNCLFVBQWtCLEVBQ2xCLFlBQXdEO0lBRXhELE9BQU8sQ0FBQyxHQUFHLElBQVUsRUFBRSxFQUFFOztRQUN2QixNQUFNLE9BQU8sR0FBRztZQUNkLFFBQVEsRUFBRSxNQUFBLFlBQVksYUFBWixZQUFZLHVCQUFaLFlBQVksQ0FBRSxRQUFRLG1DQUFJLEtBQUs7WUFDekMsT0FBTyxFQUFFLE1BQUEsWUFBWSxhQUFaLFlBQVksdUJBQVosWUFBWSxDQUFFLE9BQU8sbUNBQUksS0FBSztTQUN4QyxDQUFDO1FBRUYsTUFBTSxLQUFLLEdBQUcsU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFFakMsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFO1lBQ2xCLElBQUksT0FBTyxDQUFDLFFBQVEsRUFBRTtnQkFDcEIsTUFBTSxJQUFJLHVDQUFrQixDQUFDLElBQUksVUFBVSx1QkFBdUIsQ0FBQyxDQUFDO2FBQ3JFO1lBQ0QsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQUksT0FBTyxDQUFDLE9BQU8sRUFBRTtZQUNuQixNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBRXhDLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUN0QixNQUFNLElBQUksdUNBQWtCLENBQzFCLElBQUksVUFBVSx1QkFBdUIsS0FBSyxnQ0FBZ0MsQ0FDM0UsQ0FBQzthQUNIO1lBRUQsT0FBTyxXQUFXLENBQUM7U0FDcEI7UUFFRCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUMsQ0FBQztBQUNKLENBQUM7QUFqQ0Qsc0NBaUNDO0FBRUQsU0FBUyxTQUFTLENBQUMsR0FBRyxJQUFVO0lBQzlCLEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxFQUFFO1FBQ3pCLE1BQU0sS0FBSyxHQUFHLE9BQU8sTUFBTSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUUvRCxJQUFJLEtBQUssS0FBSyxTQUFTLElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtZQUN6QyxPQUFPLEtBQUssQ0FBQztTQUNkO0tBQ0Y7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUMifQ==