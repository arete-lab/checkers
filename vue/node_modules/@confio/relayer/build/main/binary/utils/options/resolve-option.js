"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveOption = void 0;
const InvalidOptionError_1 = require("../../exceptions/InvalidOptionError");
function resolveOption(identifier, optionsParam) {
    return (...args) => {
        var _a, _b;
        const options = {
            required: (_a = optionsParam === null || optionsParam === void 0 ? void 0 : optionsParam.required) !== null && _a !== void 0 ? _a : false,
            integer: (_b = optionsParam === null || optionsParam === void 0 ? void 0 : optionsParam.integer) !== null && _b !== void 0 ? _b : false,
        };
        const value = findValue(...args);
        if (value === null) {
            if (options.required) {
                throw new InvalidOptionError_1.InvalidOptionError(`"${identifier}" option is required.`);
            }
            return null;
        }
        if (options.integer) {
            const parsedValue = parseInt(value, 10);
            if (isNaN(parsedValue)) {
                throw new InvalidOptionError_1.InvalidOptionError(`"${identifier}" option has value "${value}" while it must be an integer.`);
            }
            return parsedValue;
        }
        return value;
    };
}
exports.resolveOption = resolveOption;
function findValue(...args) {
    for (const option of args) {
        const value = typeof option === 'function' ? option() : option;
        if (value !== undefined && value !== null) {
            return value;
        }
    }
    return null;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb2x2ZS1vcHRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvYmluYXJ5L3V0aWxzL29wdGlvbnMvcmVzb2x2ZS1vcHRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNEVBQXlFO0FBNEJ6RSxTQUFnQixhQUFhLENBQzNCLFVBQWtCLEVBQ2xCLFlBQXdEO0lBRXhELE9BQU8sQ0FBQyxHQUFHLElBQVUsRUFBRSxFQUFFOztRQUN2QixNQUFNLE9BQU8sR0FBRztZQUNkLFFBQVEsUUFBRSxZQUFZLGFBQVosWUFBWSx1QkFBWixZQUFZLENBQUUsUUFBUSxtQ0FBSSxLQUFLO1lBQ3pDLE9BQU8sUUFBRSxZQUFZLGFBQVosWUFBWSx1QkFBWixZQUFZLENBQUUsT0FBTyxtQ0FBSSxLQUFLO1NBQ3hDLENBQUM7UUFFRixNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUVqQyxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7WUFDbEIsSUFBSSxPQUFPLENBQUMsUUFBUSxFQUFFO2dCQUNwQixNQUFNLElBQUksdUNBQWtCLENBQUMsSUFBSSxVQUFVLHVCQUF1QixDQUFDLENBQUM7YUFDckU7WUFDRCxPQUFPLElBQUksQ0FBQztTQUNiO1FBRUQsSUFBSSxPQUFPLENBQUMsT0FBTyxFQUFFO1lBQ25CLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFFeEMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUU7Z0JBQ3RCLE1BQU0sSUFBSSx1Q0FBa0IsQ0FDMUIsSUFBSSxVQUFVLHVCQUF1QixLQUFLLGdDQUFnQyxDQUMzRSxDQUFDO2FBQ0g7WUFFRCxPQUFPLFdBQVcsQ0FBQztTQUNwQjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQWpDRCxzQ0FpQ0M7QUFFRCxTQUFTLFNBQVMsQ0FBQyxHQUFHLElBQVU7SUFDOUIsS0FBSyxNQUFNLE1BQU0sSUFBSSxJQUFJLEVBQUU7UUFDekIsTUFBTSxLQUFLLEdBQUcsT0FBTyxNQUFNLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBRS9ELElBQUksS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFO1lBQ3pDLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7S0FDRjtJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQyJ9